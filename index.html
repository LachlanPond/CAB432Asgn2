<html>
  <body>
    <form id ="message-entry" method="post" action="javascript:sendFormContent()">
      <h1>Twitter Sentimental Analysis</h1>
      <h4>Please enter key words to search including hashtags seperated by a comma</h4>
      <input type="Text" name="text" value="" id="text">
      <input type="submit" id="submit" value="Go">
    </form>
  <h2>Results</h2>

  <div id ="divert">
  <table id="messages" >
      <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
  </table>
  </div>

  <h2>Additional (Debugging purposes)</h2>

  <a href="/viewmessages">
    <input type="button" value="All searches made by user">
  </a>
  <br><br>
  <a href="/messages">
    <input type="button" value="Click to view JSON of all searches">
  </a>
  <br><br>
  <a href="/tweets">
    <input type="button" value="Click to view JSON of Twitter results">
  </a>

  </body>


  <script>

    onload = function conversation() {
        $.get('/tweets', function (data) {
        readMsg(data);
      });
    }

     // setTimeout(function(){
       // if (entered != old) { 
  //        window.location.reload(1);
          //old = entered;
      //  }
   //   }, 5000);

    function sendFormContent() {
      var form = $('#message-entry');
      var query = form.serialize();

      $.post('/messages', query, function (data) {
        readMsg(data);
      });

      $.post('/tweets', query, function (data) {
        readMsg(data);
      });

      entered = data;
      
    }

    function readMsg(data) {
      for (var i = 0; i < data.length; i++) {
        var msg = data[i];
        var output = '<h3>'+msg.name+' (@'+msg.username+')</h3>';
        output += '<p>'+msg.tweet+'</p>'; 
        output += '<p><i>'+msg.time+'></i></p>';  
        $("#messages").prepend(output); 
      }
    }

  </script>
      
</html>